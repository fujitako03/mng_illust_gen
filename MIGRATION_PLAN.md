# Flask → HTML移行計画

## 移行戦略

### フェーズ1: 基盤作成
1. **新しいindex.htmlファイルの作成**
   - 既存のテンプレートを参考に単一ファイル化
   - CSS/JSの組み込み

2. **JavaScript テンプレートシステム実装**
   - YAML構造をJavaScriptオブジェクトに変換
   - インメモリ処理クラス作成

### フェーズ2: API統合
1. **OpenAI API直接呼び出し実装**
   - 画像解析API呼び出し
   - 画像生成API呼び出し

2. **エラーハンドリング実装**
   - API エラー処理
   - ユーザーフレンドリーなメッセージ表示

### フェーズ3: 機能統合
1. **完全なワークフロー統合**
   - 画像アップロード → 解析 → 生成の流れ
   - UI/UX最適化

2. **テスト・検証**
   - 各機能の動作確認
   - パフォーマンステスト

## 実装方針

### 1. 段階的移行
- 既存機能を一つずつ移行
- 各段階で動作確認

### 2. 互換性維持
- 既存UIデザインを踏襲
- ユーザー体験を向上

### 3. 最小構成
- 外部依存性の削除
- 単一ファイル化

## ファイル構成変更

### 削除予定ファイル
```
app.py                 # Flask アプリケーション
templates/             # テンプレートディレクトリ
uploads/               # アップロードディレクトリ
updated_template.yaml  # 生成YAML
tests/                 # Pythonテスト
requirements.txt       # Python依存関係
runtime.txt           # Heroku設定
Procfile              # Heroku設定
pyproject.toml        # Python設定
```

### 新規ファイル
```
index.html            # 統合Webアプリ
config.js            # 設定ファイル（オプション）
```

### 保持ファイル
```
README.md             # 更新して保持
.env.example          # API Key設定例
illustration_template.yaml # 参考用（実際はJS化）
docs/                 # ドキュメント類
```

## 移行手順詳細

### ステップ1: HTMLファイル作成
1. `templates/index.html`を基に新しい`index.html`作成
2. CSS/JavaScriptをインライン化
3. 基本UI構造の動作確認

### ステップ2: テンプレートシステム移行
1. `illustration_template.yaml`をJavaScriptオブジェクトに変換
2. インメモリ処理クラス実装
3. プロンプト生成ロジック移行

### ステップ3: API統合
1. OpenAI Chat Completions API統合
2. OpenAI Images API統合
3. エラーハンドリング実装

### ステップ4: 統合テスト
1. 全体ワークフローテスト
2. エラーケーステスト
3. UI/UXテスト

### ステップ5: ドキュメント更新
1. README.md更新
2. デプロイ手順更新
3. 使用方法説明更新

## リスク管理

### 潜在的リスク
1. **API Key管理**: クライアント側での露出リスク
2. **CORS制限**: OpenAI APIのCORS制限
3. **ブラウザ制限**: ファイル処理制限

### 対策
1. **API Key**: ユーザー入力方式、注意喚起
2. **CORS**: プロキシサーバー検討（必要時）
3. **ブラウザ**: モダンブラウザ要件明記

## 成功指標

### 機能面
- [ ] 画像アップロード動作
- [ ] 特徴解析動作
- [ ] イラスト生成動作
- [ ] エラー処理動作

### 非機能面
- [ ] 単一ファイルで動作
- [ ] サーバー不要で動作
- [ ] 既存UIと同等の使いやすさ
- [ ] 処理速度の改善

この計画に従って段階的に移行を進めます。